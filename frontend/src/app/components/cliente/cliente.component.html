<div class="container">

    <div class="card" >
        <div class="card-header">
          Catálogo de clientes
        </div>
       <div class="card-body">
        <div class="table-responsive">
          <div class = "container.fluid" [@estadoFiltro] = "stateFiltro">
            <form>
             <div class="d-flex">
              <input type="text" class="text from-control me-2" placeholder="id Cliente"
              #fIdCliente (keyup) = "onFiltroChange({
                idCliente : fIdCliente.value,
                nombre : fNombre.value,
                apellido1 : fApellido1.value,
                apellido2 : fApellido2.value
              })">
              
              <input type="text" class="text from-control me-2" placeholder="Nombre"
              #fNombre (keyup) = "onFiltroChange({
                idCliente : fIdCliente.value,
                nombre : fNombre.value,
                apellido1 : fApellido1.value,
                apellido2 : fApellido2.value
              })">
              <input type="text" class="text from-control me-2" placeholder="Apellido 1"
              #fApellido1 (keyup) = "onFiltroChange({
                idCliente : fIdCliente.value,
                nombre : fNombre.value,
                apellido1 : fApellido1.value,
                apellido2 : fApellido2.value
              })">
              <input type="text" class="text from-control me-2" placeholder="Apellido 2"
              #fApellido2 (keyup) = "onFiltroChange({
                idCliente : fIdCliente.value,
                nombre : fNombre.value,
                apellido1 : fApellido1.value,
                apellido2 : fApellido2.value
              })">
              <button class = "btn btn-danger" (click) = "onFiltrar();">&times;</button>
             </div>
            </form>
          </div>
        <table class="table table-striped table-hover table-sm">
            <thead>
              <tr>
                <th scope="col">id cliente</th>
                <th scope="col">Nombre</th>
                <th scope="col">Telefono</th>
                <th scope="col">Celular</th>
                <th scope="col">Correo</th>
                <th scope="col" colspan ="3" class="text-center">
                    <button class="btn btn-success btn-sm" (click) = "onNuevo()"
                    data-bs-toggle="modal" data-bs-target="#ventanaCliente">
                        <fa-icon [icon]="['fas', 'plus']"></fa-icon>
                    </button>
                </th>
              </tr>
            </thead>
            <tbody class="table-group-divider">
              <!--*ngFor directiva-->
              <tr *ngFor = "let item of clientes | paginate: {
                itemsPerPage: itemsPPag,
                currentPage: pagActual,
                totalItems: numRegs }">
                <th scope="row">{{item.idCliente}}</th>
                <td>{{item.nombre}} {{item.apellido1}} {{item.apellido2}}</td>
                <td>{{item.telefono}}</td>
                <td>{{item.celular}}</td>
                <td>{{item.correo}}</td>
                <td class="text-center">
                  <button class="btn btn-warning btn-sm" (click) = "onEditar(item.id)"
                  data-bs-toggle="modal" data-bs-target="#ventanaCliente">
                    <fa-icon [icon]="['fas', 'pencil']"></fa-icon>
                </button>
              </td>
                <td class="text-center">
                  <button class="btn btn-danger btn-sm" (click) = 
                  "onEliminar(item.id, item.nombre+' '+item.apellido1+' '+item.apellido2);">
                    <fa-icon [icon]="['fas', 'trash']"></fa-icon>
                </button>
              </td>
                <td class="text-center">
                  <button class="btn btn-info btn-sm" (click) = "onInfo(item.id)">
                    <fa-icon [icon]="['fas', 'circle-info']"></fa-icon>
                </button>
            </td>
            </tbody>
          </table>
          <div class="alert alert-primary text-center" *ngIf ="clientes.length === 0">No se encontraron datos</div>
       </div>
    </div>
       <div class="card-footer d-flex justify-content-between pt-4">
        <div class="d-flex">
            <div class="me-2">
            <select class="form-select form-select-sm" (change) = "onCambioTama($event);">
              <option  *ngFor = "let tama of paginas" [ngValue] = "tama === itemsPPag" 
              [selected]>{{tama}}</option>
            </select>
        </div>
        <pagination-controls
        (pageChange)="onCambioPag($event)"
        previousLabel="Previous"
        nextLabel="Next">
      </pagination-controls>

         
        </div>
        <div class="botones">
            <button class="btn btn-warning btn-sm me-2"
            (click) = "onFiltrar();">
                <fa-icon [icon]="['fas', 'magnifying-glass']"></fa-icon> Filtrar</button>
            <button class="btn btn-info btn-sm me-2">
                <fa-icon [icon]="['fas', 'print']"></fa-icon> Imprimir</button>
            <button class="btn btn-danger btn-sm" (click)="onCerrar()">
                <fa-icon [icon]="['fas', 'circle-xmark']"></fa-icon> Cerrar</button>
          </div>
        </div>
       </div>
</div>

<!-- Formulario cliente-->
<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal fade" id="ventanaCliente" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">{{titulo}}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="frmCliente" [formGroup] = "frmCliente" (ngSubmit)="onSubmit();">
          <div class="row mb-2">
            <label for="idCliente" class="col-sm-3 col-form-label">Id Cliente</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="idCliente" formControlName ="idCliente">
              <div class="alert alert-danger" *ngIf = "F['idCliente'].invalid && F['idCliente'].touched">
                <div *ngIf ="F['idCliente'].errors!['required']">¡Este campo es requerido!.</div>
                <div *ngIf ="F['idCliente'].errors!['minlength']">Mínimo 9 caracteres.</div>
                <div *ngIf ="F['idCliente'].errors!['maxlength']">Máximo 15 caracteres.</div>
                <div *ngIf ="F['idCliente'].errors!['pattern']">¡Sólo valores númericos!</div>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <label for="nombre" class="col-sm-3 col-form-label">Nombre</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="nombre" formControlName ="nombre">
              <div class="alert alert-danger" *ngIf = "F['nombre'].invalid && F['nombre'].touched">
                <div *ngIf ="F['nombre'].errors!['required']">¡Este campo es requerido!.</div>
                <div *ngIf ="F['nombre'].errors!['minlength']">Mínimo 3 caracteres.</div>
                <div *ngIf ="F['nombre'].errors!['maxlength']">Máximo 30 caracteres.</div>
                <div *ngIf ="F['nombre'].errors!['pattern']">Caracter no válido.</div>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <label for="apellido1" class="col-sm-3 col-form-label">Apellido 1</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="apellido1" formControlName ="apellido1">
              <div class="alert alert-danger" *ngIf = "F['apellido1'].invalid && F['apellido1'].touched">
                <div *ngIf ="F['apellido1'].errors!['required']">¡Este campo es requerido!.</div>
                <div *ngIf ="F['apellido1'].errors!['minlength']">Mínimo 2 caracteres.</div>
                <div *ngIf ="F['apellido1'].errors!['maxlength']">Máximo 15 caracteres.</div>
                <div *ngIf ="F['apellido1'].errors!['pattern']">Caracter no válido.</div>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <label for="apellido2" class="col-sm-3 col-form-label">Apellido 2</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="apellido2" formControlName ="apellido2">
              <div class="alert alert-danger" *ngIf = "F['apellido2'].invalid && F['apellido2'].touched">
                <div *ngIf ="F['apellido2'].errors!['required']">¡Este campo es requerido!.</div>
                <div *ngIf ="F['apellido2'].errors!['minlength']">Mínimo 2 caracteres.</div>
                <div *ngIf ="F['apellido2'].errors!['maxlength']">Máximo 15 caracteres.</div>
                <div *ngIf ="F['apellido2'].errors!['pattern']">Caracter no válido.</div>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <label for="telefono" class="col-sm-3 col-form-label">Telefono</label>
            <div class="col-sm-9">
              <input type="tel" class="form-control" id="telefono" formControlName ="telefono" placeholder="0000-0000">
              <div class="alert alert-danger" *ngIf = "F['telefono'].invalid && F['telefono'].touched">
                <div *ngIf ="F['telefono'].errors!['required']">¡Este campo es requerido!.</div>
               <div *ngIf ="F['telefono'].errors!['pattern']">¡Caracter no válido ó formato no válidos!</div>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <label for="celular" class="col-sm-3 col-form-label">Celular</label>
            <div class="col-sm-9">
              <input type="tel" class="form-control" id="celular" formControlName ="celular" placeholder="0000-0000">
              <div class="alert alert-danger" *ngIf = "F['celular'].invalid && F['celular'].touched">
                <div *ngIf ="F['celular'].errors!['pattern']">Caracter no válido.</div>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <label for="correo" class="col-sm-3 col-form-label">Correo</label>
            <div class="col-sm-9">
              <input type="email" class="form-control" id="correo" formControlName ="correo">
              <div class="alert alert-danger" *ngIf = "F['correo'].invalid && F['correo'].touched">
                <div *ngIf ="F['correo'].errors!['required']">¡Este campo es requerido!.</div>
               <div *ngIf ="F['correo'].errors!['email']">Email no válido</div>
              </div>
            </div>
          </div>
          <div class="form-floating">
            <textarea class="form-control" placeholder="Dirección" id="direccion" style="height: 100px" formControlName ="direccion"></textarea>
            <label for="direccion">Dirección</label>
            <div class="alert alert-danger" *ngIf = "F['direccion'].invalid && F['direccion'].touched">
             <div *ngIf ="F['direccion'].errors!['minlengh']">Mínimo de 5 caracteres</div>
            </div>
          </div>
          <div>
            <input type="hidden" formControlName ="id">
            <input type="hidden" formControlName ="fechaIngreso">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" form = "frmCliente" [disabled]="frmCliente.invalid">Guardar</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
